import{a,p as y}from"./chunk-UIGDSWPH-DaYfYYzD.js";const h="https://dog-walking-app.onrender.com";async function e(t,o={}){const{timeout:n=8e3,...c}=o,r=new AbortController,l=setTimeout(()=>r.abort(),n);try{const s=await fetch(`${h}${t}`,{...c,credentials:"include",signal:r.signal,headers:{"Content-Type":"application/json",...c.headers}});if(clearTimeout(l),!s.ok){const d=await s.json().catch(()=>({}));throw new Error(d.errors?.join(", ")||d.error||"API request failed")}return await s.json()}catch(s){throw s instanceof Error?s.name==="AbortError"?new Error("Request timeout"):s:new Error("Unknown error occurred")}}const E={getAll:()=>e("/training_sessions"),getSummary:()=>e("/training_sessions/summary"),getThisWeek:()=>e("/training_sessions/this_week"),getThisMonth:()=>e("/training_sessions/this_month"),create:t=>e("/training_sessions",{method:"POST",body:JSON.stringify({training_session:t})}),update:(t,o)=>e(`/training_sessions/${t}`,{method:"PATCH",body:JSON.stringify({training_session:o})}),delete:t=>e(`/training_sessions/${t}`,{method:"DELETE"}),exportCSV:async()=>{const t=await fetch(`${h}/training_sessions/export`,{credentials:"include"});if(!t.ok)throw new Error("Export failed");return await t.blob()},syncFromInvoices:()=>e("/training_sessions/sync_from_invoices",{method:"POST"})},_={get:()=>e("/certification_goal"),create:t=>e("/certification_goal",{method:"POST",body:JSON.stringify({certification_goal:t})}),update:t=>e("/certification_goal",{method:"PATCH",body:JSON.stringify({certification_goal:t})})},P={getAll:()=>e("/milestones"),markCelebrated:t=>e(`/milestones/${t}/mark_celebrated`,{method:"PATCH"})},S={get:()=>e("/training/dashboard")},b={get:()=>e("/training/stats")},T={getAll:()=>e("/pets"),create:t=>e("/pets",{method:"POST",body:JSON.stringify({pet:t})}),update:(t,o)=>e(`/pets/${t}`,{method:"PATCH",body:JSON.stringify(o)}),delete:t=>e(`/pets/${t}`,{method:"DELETE"}),updateActiveStatus:(t,o)=>e(`/pets/${t}/active`,{method:"PATCH",body:JSON.stringify({active:o})})},A={login:(t,o)=>e("/login",{method:"POST",body:JSON.stringify({username:t,password:o})})},u=a.createContext(void 0);function O({children:t}){const[o,n]=a.useState(!1),[c,r]=a.useState(!0),[l,s]=a.useState(null);a.useEffect(()=>{d()},[]);const d=async()=>{try{const i=await fetch("https://dog-walking-app.onrender.com/training/dashboard",{credentials:"include"});n(i.ok)}catch{n(!1)}finally{r(!1)}},f=async(i,p)=>{try{s(null),r(!0),await A.login(i,p),n(!0)}catch(g){throw s(g instanceof Error?g.message:"Login failed"),g}finally{r(!1)}},m=async()=>{try{await fetch("https://dog-walking-app.onrender.com/logout",{method:"DELETE",credentials:"include"})}catch(i){console.error("Logout error:",i)}finally{n(!1)}};return y.jsx(u.Provider,{value:{isAuthenticated:o,isLoading:c,login:f,logout:m,error:l},children:t})}function k(){const t=a.useContext(u);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}export{O as A,_ as c,S as d,P as m,T as p,b as s,E as t,k as u};
