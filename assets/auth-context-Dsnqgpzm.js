import{a,p}from"./chunk-UIGDSWPH-DaYfYYzD.js";const u="https://pocket-walks.com";async function e(t,s={}){const{timeout:n=8e3,...c}=s,r=new AbortController,d=setTimeout(()=>r.abort(),n);try{const o=await fetch(`${u}${t}`,{...c,credentials:"include",signal:r.signal,headers:{"Content-Type":"application/json",...c.headers}});if(clearTimeout(d),!o.ok){const l=await o.json().catch(()=>({}));throw new Error(l.errors?.join(", ")||l.error||"API request failed")}return await o.json()}catch(o){throw o instanceof Error?o.name==="AbortError"?new Error("Request timeout"):o:new Error("Unknown error occurred")}}const E={getAll:()=>e("/training_sessions"),getSummary:()=>e("/training_sessions/summary"),getThisWeek:()=>e("/training_sessions/this_week"),getThisMonth:()=>e("/training_sessions/this_month"),create:t=>e("/training_sessions",{method:"POST",body:JSON.stringify({training_session:t})}),update:(t,s)=>e(`/training_sessions/${t}`,{method:"PATCH",body:JSON.stringify({training_session:s})}),delete:t=>e(`/training_sessions/${t}`,{method:"DELETE"}),exportCSV:async()=>{const t=await fetch(`${u}/training_sessions/export`,{credentials:"include"});if(!t.ok)throw new Error("Export failed");return await t.blob()},syncFromInvoices:()=>e("/training_sessions/sync_from_invoices",{method:"POST"})},_={get:()=>e("/certification_goal"),create:t=>e("/certification_goal",{method:"POST",body:JSON.stringify({certification_goal:t})}),update:t=>e("/certification_goal",{method:"PATCH",body:JSON.stringify({certification_goal:t})})},P={getAll:()=>e("/milestones"),markCelebrated:t=>e(`/milestones/${t}/mark_celebrated`,{method:"PATCH"})},S={get:()=>e("/training/dashboard")},b={get:()=>e("/training/stats")},T={getAll:()=>e("/pets"),create:t=>e("/pets",{method:"POST",body:JSON.stringify({pet:t})}),update:(t,s)=>e(`/pets/${t}`,{method:"PATCH",body:JSON.stringify(s)}),delete:t=>e(`/pets/${t}`,{method:"DELETE"}),updateActiveStatus:(t,s)=>e(`/pets/${t}/active`,{method:"PATCH",body:JSON.stringify({active:s})})},A={login:(t,s)=>e("/login",{method:"POST",body:JSON.stringify({username:t,password:s})})},g=a.createContext(void 0);function O({children:t}){const[s,n]=a.useState(!1),[c,r]=a.useState(!0),[d,o]=a.useState(null);a.useEffect(()=>{l()},[]);const l=async()=>{try{const i=await fetch("http://localhost:3000/training/dashboard",{credentials:"include"});n(i.ok)}catch{n(!1)}finally{r(!1)}},f=async(i,y)=>{try{o(null),r(!0),await A.login(i,y),n(!0)}catch(h){throw o(h instanceof Error?h.message:"Login failed"),h}finally{r(!1)}},m=async()=>{try{await fetch("http://localhost:3000/logout",{method:"DELETE",credentials:"include"})}catch(i){console.error("Logout error:",i)}finally{n(!1)}};return p.jsx(g.Provider,{value:{isAuthenticated:s,isLoading:c,login:f,logout:m,error:d},children:t})}function x(){const t=a.useContext(g);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}export{O as A,_ as c,S as d,P as m,T as p,b as s,E as t,x as u};
